---
title: Gene enrichment
author: Simon Urbanek
date: '2023-10-13'
slug: gene-enrichment
categories: [quantitative biology]
tags: [transcriptomics,genes]
---

# Enrichment analysis

Having obtained a file with the results of a DSeq2 differential expression calculation (stored below in the variable `datafile`), we perform an enrichment analysis in different databases.

## Install packages


```r
# if (!requireNamespace("BiocManager", quietly = TRUE))
#     install.packages("BiocManager")
# 
# BiocManager::install("clusterProfiler")
# BiocManager::install("org.Hs.eg.db")
#BiocManager::install("ReactomePA")
# 
# install.packages("enrichplot", repos = "https://cran.r-project.org")
# install.packages("enrichR", repos = "https://cran.r-project.org")
# install.packages("crayon", repos = "https://cran.r-project.org")
# install.packages("GOSemSim")
# install.packages("DOSE")
```
## Load the list of genes

```r
datafile <- 'data/Control_vs_NPDR.tsv'
df <- read.csv(datafile,header=TRUE,sep='\t')
head(df)
```

```
##    baseMean log2FoldChange      lfcSE        stat    pvalue      padj
## 1 185.56242   -0.126242767 0.16107710 -0.78374127 0.4331919 0.8659343
## 2 340.60831    0.001635086 0.05954194  0.02746107 0.9780920 0.9973564
## 3 677.30073   -0.120702090 0.09202774 -1.31158381 0.1896606 0.7582487
## 4 526.98118   -0.100109126 0.09653793 -1.03699263 0.2997393 0.8125926
## 5  33.66775    0.201784965 0.22035584  0.91572326 0.3598121 0.8367488
## 6 182.38657    0.126651588 0.17959728  0.70519768 0.4806872 0.8823537
##              gene ext_gene
## 1 ENSG00000000003   TSPAN6
## 2 ENSG00000000419     DPM1
## 3 ENSG00000000457    SCYL3
## 4 ENSG00000000460 C1orf112
## 5 ENSG00000000938      FGR
## 6 ENSG00000000971      CFH
```

```r
# obtain the log2foldchage column
original_gene_list <- df$log2FoldChange
# name the vector
names(original_gene_list) <- df$ext_gene
# sort the list in dicreasing order, required for clusterprolfier
gene_list <- sort(original_gene_list, decreasing = TRUE)
gene_list
```

```
##      CEACAM21     TNFRSF12A          PDK4           ZFX        PNPLA4 
##  0.7705382035  0.6003450552  0.5524460136  0.3603907013  0.3538773057 
##          TAC1          SCIN          ICA1        TBXA2R        THSD7A 
##  0.3504567603  0.3225885594  0.2915307860  0.2704528186  0.2626248059 
##           ST7        CAMKK1         FKBP4       CACNA1G           FGR 
##  0.2190007601  0.2132132219  0.2036164416  0.2024873705  0.2017849655 
##      ARHGAP44        PLXND1        DBNDD1       CYP51A1         ABCC8 
##  0.1881552411  0.1796371229  0.1737849306  0.1682591305  0.1440170989 
##          GGCT        MAP3K9           CFH         HECW1         CDKL3 
##  0.1423846558  0.1296188327  0.1266515883  0.1245714860  0.1216304414 
##        NIPAL3      PAFAH1B1          RBM6         CRLF1       SLC25A5 
##  0.1202164773  0.1174632091  0.1173795404  0.1141188020  0.1081010179 
##          SOX8          ARSD        MYCBP2        SLC7A2        SEMA3F 
##  0.1065941177  0.1017087076  0.1013181785  0.0986204734  0.0978453011 
##         CFLAR         KDM7A        KLHL13         FUCA2         GCFC2 
##  0.0922400624  0.0914646947  0.0898494188  0.0891516815  0.0851226260 
##        HS3ST1         TTC22         RPAP3          MSL3       MAP3K14 
##  0.0793203094  0.0787827210  0.0782598326  0.0776263682  0.0760503656 
##          MCUB         CDC27         ELAC2          UPP2        CREBBP 
##  0.0754364962  0.0745824841  0.0738290209  0.0646498845  0.0644266487 
##      GTF2IRD1          LAP3         RAD52       NDUFAF7       CIAPIN1 
##  0.0624378149  0.0606629645  0.0598556712  0.0594719694  0.0576290740 
##         MTMR7         COX10       POLDIP2         KMT2E        REX1BD 
##  0.0559747324  0.0535339967  0.0519544437  0.0454867045  0.0448550688 
##        CASP10        RHBDD2          IBTK      SLC25A13           MPO 
##  0.0437682555  0.0436880402  0.0426565133  0.0418070510  0.0411406955 
##          RBM5        ZNF195          PAF1       NDUFAB1         PHTF2 
##  0.0411081687  0.0389028264  0.0381923840  0.0350534319  0.0343771824 
##        SPPL2B         VPS41        MAD1L1       FAM214B         KDM1A 
##  0.0310342164  0.0280852476  0.0279424409  0.0231357429  0.0222068701 
##       TSPOAP1        CX3CL1          LIG3          RALA        CACNG3 
##  0.0219741830  0.0211195934  0.0205522202  0.0188750334  0.0161660057 
##          GCLC         CCL26         IFRD1         STPG1          ALS2 
##  0.0139803216  0.0099466684  0.0094944410  0.0087666189  0.0073532074 
##        TMEM98         AP2B1      TMEM176A          DPM1         ITGAL 
##  0.0051968212  0.0032496215  0.0020385392  0.0016350856  0.0002882748 
##          GDE1         SARM1        ITGA2B          UPF1         LASP1 
## -0.0007250660 -0.0008626006 -0.0011848213 -0.0024231426 -0.0025871147 
##         VPS50          DBF4          DVL2       PRKAR2B          TFPI 
## -0.0044971016 -0.0047008763 -0.0047851318 -0.0058576213 -0.0071333755 
##         SKAP2         ITGA3       ADIPOR2         KRIT1         LAMP2 
## -0.0094420458 -0.0100236568 -0.0114953310 -0.0138692438 -0.0190986667 
##         MARK4         LAS1L        ANKIB1          HCCS           AGK 
## -0.0200052343 -0.0205004236 -0.0226380749 -0.0250693271 -0.0256452585 
##        ZNF263           BAD          NOS2         DHX33         USH1C 
## -0.0317273489 -0.0319053046 -0.0355851039 -0.0359349653 -0.0388971844 
##      ARHGAP33         FBXL3         ENPP4          ARF5          PDK2 
## -0.0452710613 -0.0483118762 -0.0538908651 -0.0585849016 -0.0594915148 
##         FARP2       SPATA20      BAIAP2L1         HSPB6          ETV1 
## -0.0603403559 -0.0671205434 -0.0745606347 -0.0764320692 -0.0783767705 
##         COPZ2         RECQL          M6PR          YBX2      C1orf112 
## -0.0825836873 -0.0841366035 -0.0881723535 -0.0971515818 -0.1001091260 
##       CCDC124        POLR2J         REXO5    AC003665.1         SCYL3 
## -0.1092688672 -0.1098458163 -0.1129506308 -0.1186352138 -0.1207020899 
##        TSPAN6         SNX11          CROT           AK2       ALDH3B1 
## -0.1262427672 -0.1276504541 -0.1514002215 -0.1565600278 -0.1628436436 
##         PROM1          NFYA      TMEM132A       ZMYND10         WDR54 
## -0.1683702810 -0.1749299246 -0.1973727546 -0.2559361114 -0.2653734932 
##          CD99         WNT16       CYP26B1 
## -0.2858500051 -0.3210967019 -0.4104532258
```

```r
output_dir <- 'results'
```
## Load libraries

```r
library(clusterProfiler)
```

```
## 
```

```
## Registered S3 methods overwritten by 'treeio':
##   method              from    
##   MRCA.phylo          tidytree
##   MRCA.treedata       tidytree
##   Nnode.treedata      tidytree
##   Ntip.treedata       tidytree
##   ancestor.phylo      tidytree
##   ancestor.treedata   tidytree
##   child.phylo         tidytree
##   child.treedata      tidytree
##   full_join.phylo     tidytree
##   full_join.treedata  tidytree
##   groupClade.phylo    tidytree
##   groupClade.treedata tidytree
##   groupOTU.phylo      tidytree
##   groupOTU.treedata   tidytree
##   inner_join.phylo    tidytree
##   inner_join.treedata tidytree
##   is.rooted.treedata  tidytree
##   nodeid.phylo        tidytree
##   nodeid.treedata     tidytree
##   nodelab.phylo       tidytree
##   nodelab.treedata    tidytree
##   offspring.phylo     tidytree
##   offspring.treedata  tidytree
##   parent.phylo        tidytree
##   parent.treedata     tidytree
##   root.treedata       tidytree
##   rootnode.phylo      tidytree
##   sibling.phylo       tidytree
```

```
## clusterProfiler v4.8.3  For help: https://yulab-smu.top/biomedical-knowledge-mining-book/
## 
## If you use clusterProfiler in published research, please cite:
## T Wu, E Hu, S Xu, M Chen, P Guo, Z Dai, T Feng, L Zhou, W Tang, L Zhan, X Fu, S Liu, X Bo, and G Yu. clusterProfiler 4.0: A universal enrichment tool for interpreting omics data. The Innovation. 2021, 2(3):100141
```

```
## 
## Attaching package: 'clusterProfiler'
```

```
## The following object is masked from 'package:stats':
## 
##     filter
```

```r
# library(org.Hs.eg.db)
# library(GOSemSim)
# library(DOSE)
# library(enrichR)
# library(crayon) # So messages can be in blue font
library(enrichplot)
```

## Run the analysis on different Ontologies

### Perform analysis on enrichPathway








